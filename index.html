<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Teams 日文即時字幕翻譯（安全版）</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Teams 日文即時字幕翻譯（免費+安全版）</h1>
  <div id="subtitleDisplay"></div>
  <button id="startBtn">開始翻譯</button>
  <button onclick="exportSRT()">下載 SRT</button>
  <button onclick="exportTXT()">下載 TXT</button>

  <!-- Vercel will inject this -->
  <script>
    window.OPENAI_API_KEY = "%OPENAI_API_KEY%";
  </script>

  <script type="module">
    import { startSpeechRecognition } from './speech_recognition.js';
    import { saveSRT, saveSRTasTXT } from './srt_exporter.js';
    window.exportSRT = saveSRT;
    window.exportTXT = saveSRTasTXT;
    document.getElementById("startBtn").addEventListener("click", startSpeechRecognition);
  </script>
</body>
</html>
